{% extends 'base.html' %}

{% block header %}
    {% block title %}Camera Configurations{% endblock %}
{% endblock %}

{% block content %}
    <div class="w3-bar w3-green">
        <!-- Config menue -->
        {% if sc.lastConfigTab == "cfglive" %}
        <button class="w3-bar-item w3-button configmenu w3-light-green" id="cfglivebtn" onclick="openCfgTab('cfglive', 'cfglivebtn')">Live View</button>
        {% else %}
        <button class="w3-bar-item w3-button configmenu" id="cfglivebtn" onclick="openCfgTab('cfglive', 'cfglivebtn')">Live View</button>
        {% endif %}
        {% if sc.lastConfigTab == "cfgphoto" %}
        <button class="w3-bar-item w3-button configmenu w3-light-green" id="cfgphotobtn" onclick="openCfgTab('cfgphoto', 'cfgphotobtn')">Photo</button>
        {% else %}
        <button class="w3-bar-item w3-button configmenu" id="cfgphotobtn" onclick="openCfgTab('cfgphoto', 'cfgphotobtn')">Photo</button>
        {% endif %}
        {% if sc.lastConfigTab == "cfgraw" %}
        <button class="w3-bar-item w3-button configmenu w3-light-green" id="cfgrawbtn"
            onclick="openCfgTab('cfgraw', 'cfgrawbtn')">Raw Photo</button>
        {% else %}
        <button class="w3-bar-item w3-button configmenu" id="cfgphotobtn"
            onclick="openCfgTab('cfgraw', 'cfgrawbtn')">Raw Photo</button>
        {% endif %}
        {% if sc.lastConfigTab == "cfgvideo" %}
        <button class="w3-bar-item w3-button configmenu w3-light-green" id="cfgvideobtn"
            onclick="openCfgTab('cfgvideo', 'cfgvideobtn')">Video</button>
        {% else %}
        <button class="w3-bar-item w3-button configmenu" id="cfgphotobtn" 
            onclick="openCfgTab('cfgvideo', 'cfgvideobtn')">Video</button>
        {% endif %}
    </div>
    <!-- Live View configuration -->
    {% if sc.lastConfigTab == "cfglive" %}
    <div id="cfglive" class="cfggroup">
    {% else %}
    <div id="cfglive" class="cfggroup" style="display:none">
    {% endif %}
        <h4>Configuration for Live View</h4>
        {% set cfg = cfglive %}
        <div>
            <form method="post" action="{{ url_for('config.liveViewCfg') }}">
                <table class="w3-table-all">
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This is the unique ID of the configuration. It is only used to distinguish
                                different configuration sets within this application. 
                                It is not relevant for the camera system.
                            </span>
                            <label for="LIVE_id">ID:</label>
                        </td>
                        <td colspan="2">
                            <input id="LIVE_id" name="LIVE_id" value="{{ cfg.id }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Usecase for this configuration.
                            </span>
                            <label for="LIVE_use_case">Use Case:</label>
                        </td>
                        <td colspan="2">
                            <input id="LIVE_use_case" name="LIVE_use_case" value="{{ cfg.use_case }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether camera images are horizontally or vertically mirrored, 
                                or both (giving a 180 degree rotation).
                            </span>
                            <label for="LIVE_transform_hflip">Transform (flip ↔ or ↕ ):</label>
                        </td>
                        <td style="width:5%">
                            ↔
                            {% if cfg.transform_hflip == true %}
                            <input type="checkbox" id="LIVE_transform_hflip" name="LIVE_transform_hflip" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="LIVE_transform_hflip" name="LIVE_transform_hflip" value="0">
                            {% endif %}
                        </td>
                        <td style="width:5%">
                            ↕
                            {% if cfg.transform_vflip == true %}
                            <input type="checkbox" id="LIVE_transform_vflip" name="LIVE_transform_vflip" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="LIVE_transform_vflip" name="LIVE_transform_vflip" value="0">
                            {% endif %}
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                The colour space of the output images. 
                                The main and lores streams must always share the same colour space.
                                The raw stream is always in a camera-specific colour space.
                            </span>
                            <label for="LIVE_colour_space">Colour Space:</label>
                        </td>
                        <td colspan="2">
                            <select name="LIVE_colour_space" id="LIVE_colour_space">
                                {% if cfg.colour_space == "sYCC" %}
                                <option value="sYCC" selected>sYCC</option>
                                {% else %}
                                <option value="sYCC">sYCC</option>
                                {% endif %}
                                {% if cfg.colour_space == "Smpte170m" %}
                                <option value="Smpte170m" selected>Smpte170m</option>
                                {% else %}
                                <option value="Smpte170m">Smpte170m</option>
                                {% endif %}
                                {% if cfg.colour_space == "Rec709" %}
                                <option value="Rec709" selected>Rec709</option>
                                {% else %}
                                <option value="Rec709">Rec709</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                the number of sets of buffers to allocate for the camera system. 
                                A single set of buffers represents
                                one buffer for each of the streams that have been requested.
                            </span>
                            <label for="LIVE_buffer_count">Buffer Count:</label>
                        </td>
                        <td colspan="2">
                            <input type="number" id="LIVE_buffer_count" name="LIVE_buffer_count" min="1" max="6" value="{{ cfg.buffer_count }}">
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is allowed to queue up a frame 
                                ready for a capture request.
                            </span>
                            <label for="LIVE_queue">Queue:</label>
                        </td>
                        <td colspan="2">
                            {% if cfg.queue == True %}
                            <input type="checkbox" id="LIVE_queue" name="LIVE_queue" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="LIVE_queue" name="LIVE_queue" value="0">
                            {% endif %}
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                            <!-- This cell is used to store an invisible list of sensor mode data -->
                            {% for mode in sm %}
                            <p id="sensormode_ref{{ mode.id }}" style="display:none">Size: {{ mode.size }} FPS: {{ mode.fps }} Bit Depth: {{ mode.bit_depth }}</p>
                            {% endfor%}
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Sensor Mode to be used in this configuration<br>
                                For details, see the available Sensor Modos under 'Info'
                            </span>
                            <label for="LIVE_sensor_mode">Sensor Mode:</label>
                        </td>
                        <td colspan="2">
                            <select name="LIVE_sensor_mode" id="LIVE_sensor_mode" onchange="sensorModeChanged('LIVE_sensor_mode', 'LIVE_sensor_mode_data')">
                                {% for mode in sm %}
                                {% if cfg.sensor_mode == mode.id %}
                                <option value="{{ mode.id }}" selected>Sensor Mode {{ mode.id }}</option>
                                {% else %}
                                <option value="{{ mode.id }}">Sensor Mode {{ mode.id }}</option>
                                {% endif %}
                                {% endfor%}
                            </select>
                        </td>
                        <td style="width:50%" id="LIVE_sensor_mode_data">
                            {% for mode in sm %}
                            {% if cfg.sensor_mode == mode.id %}
                            Size: {{ mode.size }} FPS: {{ mode.fps }} Bit Depth: {{ mode.bit_depth }}
                            {% endif %}
                            {% endfor%}
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Camera stream to use
                            </span>
                            <label for="LIVE_stream">Stream:</label>
                        </td>
                        <td colspan="2">
                            <select name="LIVE_stream" id="LIVE_stream">
                                {% if cfg.stream == "main" %}
                                <option value="main" selected>main</option>
                                {% else %}
                                <option value="main">main</option>
                                {% endif %}
                                {% if cfg.stream == "lores" %}
                                <option value="lores" selected>lores</option>
                                {% else %}
                                <option value="lores">lores</option>
                                {% endif %}
                                {% if cfg.stream == "raw" %}
                                <option value="raw" selected>raw</option>
                                {% else %}
                                <option value="raw">raw</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Image format to be used
                            </span>
                            <label for="LIVE_format">Format:</label>
                        </td>
                        <td colspan="2">
                            <select name="LIVE_format" id="LIVE_format">
                                {% if cfg.format == "XBGR8888" %}
                                <option value="XBGR8888" selected>XBGR8888</option>
                                {% else %}
                                <option value="XBGR8888">XBGR8888</option>
                                {% endif %}
                                {% if cfg.format == "XRGB8888" %}
                                <option value="XRGB8888" selected>XRGB8888</option>
                                {% else %}
                                <option value="XRGB8888">XRGB8888</option>
                                {% endif %}
                                {% if cfg.format == "RGB888" %}
                                <option value="RGB888" selected>RGB888</option>
                                {% else %}
                                <option value="RGB888">RGB888</option>
                                {% endif %}
                                {% if cfg.format == "BGR888" %}
                                <option value="BGR888" selected>BGR888</option>
                                {% else %}
                                <option value="BGR888">BGR888</option>
                                {% endif %}
                                {% if cfg.format == "YUV420" %}
                                <option value="YUV420" selected>YUV420</option>
                                {% else %}
                                <option value="YUV420">YUV420</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the camera streams are to be shown in the preview window. <br>
                                Note: Preview view is not used within this applacation.
                            </span>
                            <label for="LIVE_display">Display:</label>
                        </td>
                        <td colspan="2">
                            <input id="LIVE_display" name="LIVE_display" value="{{ cfg.display }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the streams are to be encoded if a video recording is started. 
                            </span>
                            <label for="LIVE_encode">Encode:</label>
                        </td>
                        <td colspan="2">
                            <input id="LIVE_encode" name="LIVE_encode" value="{{ cfg.encode }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5">
                            Controls included in Configuration
                        </td>
                    </tr>
                    {% for ctrl_key, ctrl_value in cfg.controls.items() %}
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <label for="LIVE_display">{{ ctrl_key }}:</label>
                        </td>
                        <td colspan="2">
                            <input id="LIVE_display" name="LIVE_display" value="{{ ctrl_value }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    {% endfor%}
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" type="submit" value="Submit & Apply">
            </form>
        </div>
    </div>

    <!-- Photo configuration -->
    {% if sc.lastConfigTab == "cfgphoto" %}
    <div id="cfgphoto" class="cfggroup">
    {% else %}
    <div id="cfgphoto" class="cfggroup" style="display:none">
    {% endif %}
        <h4>Configuration for Photo Taking</h4>
        {% set cfg = cfgphoto %}
        {% set cfgId = "FOTO" %}
        <div>
            <form method="post" action="{{ url_for('config.photoCfg') }}">
                <table class="w3-table-all">
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This is the unique ID of the configuration. It is only used to distinguish
                                different configuration sets within this application.
                                It is not relevant for the camera system.
                            </span>
                            <label for="{{ cfgId }}_id">ID:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_id" name="{{ cfgId }}_id" value="{{ cfg.id }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Usecase for this configuration.
                            </span>
                            <label for="{{ cfgId }}_use_case">Use Case:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_use_case" name="{{ cfgId }}_use_case" value="{{ cfg.use_case }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether camera images are horizontally or vertically mirrored,
                                or both (giving a 180 degree rotation).
                            </span>
                            <label for="{{ cfgId }}_transform_hflip">Transform (flip ↔ or ↕ ):</label>
                        </td>
                        <td style="width:5%">
                            ↔
                            {% if cfg.transform_hflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip" value="1"
                                checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip"
                                value="0">
                            {% endif %}
                        </td>
                        <td style="width:5%">
                            ↕
                            {% if cfg.transform_vflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip" value="1"
                                checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip"
                                value="0">
                            {% endif %}
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                The colour space of the output images.
                                The main and lores streams must always share the same colour space.
                                The raw stream is always in a camera-specific colour space.
                            </span>
                            <label for="{{ cfgId }}_colour_space">Colour Space:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_colour_space" id="{{ cfgId }}_colour_space">
                                {% if cfg.colour_space == "sYCC" %}
                                <option value="sYCC" selected>sYCC</option>
                                {% else %}
                                <option value="sYCC">sYCC</option>
                                {% endif %}
                                {% if cfg.colour_space == "Smpte170m" %}
                                <option value="Smpte170m" selected>Smpte170m</option>
                                {% else %}
                                <option value="Smpte170m">Smpte170m</option>
                                {% endif %}
                                {% if cfg.colour_space == "Rec709" %}
                                <option value="Rec709" selected>Rec709</option>
                                {% else %}
                                <option value="Rec709">Rec709</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                the number of sets of buffers to allocate for the camera system.
                                A single set of buffers represents
                                one buffer for each of the streams that have been requested.
                            </span>
                            <label for="{{ cfgId }}_buffer_count">Buffer Count:</label>
                        </td>
                        <td colspan="2">
                            <input type="number" id="{{ cfgId }}_buffer_count" name="{{ cfgId }}_buffer_count" min="1" max="6"
                                value="{{ cfg.buffer_count }}">
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is allowed to queue up a frame
                                ready for a capture request.
                            </span>
                            <label for="{{ cfgId }}_queue">Queue:</label>
                        </td>
                        <td colspan="2">
                            {% if cfg.queue == True %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" value="0">
                            {% endif %}
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Sensor Mode to be used in this configuration<br>
                                For details, see the available Sensor Modos under 'Info'
                            </span>
                            <label for="{{ cfgId }}_sensor_mode">Sensor Mode:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_sensor_mode" id="{{ cfgId }}_sensor_mode"
                                onchange="sensorModeChanged('{{ cfgId }}_sensor_mode', '{{ cfgId }}_sensor_mode_data')">
                                {% for mode in sm %}
                                {% if cfg.sensor_mode == mode.id %}
                                <option value="{{ mode.id }}" selected>Sensor Mode {{ mode.id }}</option>
                                {% else %}
                                <option value="{{ mode.id }}">Sensor Mode {{ mode.id }}</option>
                                {% endif %}
                                {% endfor%}
                            </select>
                        </td>
                        <td style="width:50%" id="{{ cfgId }}_sensor_mode_data">
                            {% for mode in sm %}
                            {% if cfg.sensor_mode == mode.id %}
                            Size: {{ mode.size }} FPS: {{ mode.fps }} Bit Depth: {{ mode.bit_depth }}
                            {% endif %}
                            {% endfor%}
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Camera stream to use
                            </span>
                            <label for="{{ cfgId }}_stream">Stream:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_stream" id="{{ cfgId }}_stream">
                                {% if cfg.stream == "main" %}
                                <option value="main" selected>main</option>
                                {% else %}
                                <option value="main">main</option>
                                {% endif %}
                                {% if cfg.stream == "lores" %}
                                <option value="lores" selected>lores</option>
                                {% else %}
                                <option value="lores">lores</option>
                                {% endif %}
                                {% if cfg.stream == "raw" %}
                                <option value="raw" selected>raw</option>
                                {% else %}
                                <option value="raw">raw</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Image format to be used
                            </span>
                            <label for="{{ cfgId }}_format">Format:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_format" id="{{ cfgId }}_format">
                                {% if cfg.format == "XBGR8888" %}
                                <option value="XBGR8888" selected>XBGR8888</option>
                                {% else %}
                                <option value="XBGR8888">XBGR8888</option>
                                {% endif %}
                                {% if cfg.format == "XRGB8888" %}
                                <option value="XRGB8888" selected>XRGB8888</option>
                                {% else %}
                                <option value="XRGB8888">XRGB8888</option>
                                {% endif %}
                                {% if cfg.format == "RGB888" %}
                                <option value="RGB888" selected>RGB888</option>
                                {% else %}
                                <option value="RGB888">RGB888</option>
                                {% endif %}
                                {% if cfg.format == "BGR888" %}
                                <option value="BGR888" selected>BGR888</option>
                                {% else %}
                                <option value="BGR888">BGR888</option>
                                {% endif %}
                                {% if cfg.format == "YUV420" %}
                                <option value="YUV420" selected>YUV420</option>
                                {% else %}
                                <option value="YUV420">YUV420</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the camera streams are to be shown in the preview window. <br>
                                Note: Preview view is not used within this applacation.
                            </span>
                            <label for="{{ cfgId }}_display">Display:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_display" name="{{ cfgId }}_display" value="{{ cfg.display }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the streams are to be encoded if a video recording is started.
                            </span>
                            <label for="{{ cfgId }}_encode">Encode:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_encode" name="{{ cfgId }}_encode" value="{{ cfg.encode }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5">
                            Controls included in Configuration
                        </td>
                    </tr>
                    {% for ctrl_key, ctrl_value in cfg.controls.items() %}
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <label for="{{ cfgId }}_display">{{ ctrl_key }}:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_display" name="{{ cfgId }}_display" value="{{ ctrl_value }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    {% endfor%}
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" type="submit" value="Submit">
            </form>
        </div>    
    </div>

    <!-- Raw Photo configuration -->
    {% if sc.lastConfigTab == "cfgraw" %}
    <div id="cfgraw" class="cfggroup">
    {% else %}
    <div id="cfgraw" class="cfggroup" style="display:none">
    {% endif %}
        <h4>Configuration for Raw Photo Taking</h4>
        {% set cfg = cfgraw %}
        {% set cfgId = "PRAW" %}
        <div>
            <form method="post" action="{{ url_for('config.rawCfg') }}">
                <table class="w3-table-all">
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This is the unique ID of the configuration. It is only used to distinguish
                                different configuration sets within this application.
                                It is not relevant for the camera system.
                            </span>
                            <label for="{{ cfgId }}_id">ID:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_id" name="{{ cfgId }}_id" value="{{ cfg.id }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Usecase for this configuration.
                            </span>
                            <label for="{{ cfgId }}_use_case">Use Case:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_use_case" name="{{ cfgId }}_use_case" value="{{ cfg.use_case }}"
                                disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether camera images are horizontally or vertically mirrored,
                                or both (giving a 180 degree rotation).
                            </span>
                            <label for="{{ cfgId }}_transform_hflip">Transform (flip ↔ or ↕ ):</label>
                        </td>
                        <td style="width:5%">
                            ↔
                            {% if cfg.transform_hflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip"
                                value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip"
                                value="0">
                            {% endif %}
                        </td>
                        <td style="width:5%">
                            ↕
                            {% if cfg.transform_vflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip"
                                value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip"
                                value="0">
                            {% endif %}
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                The colour space of the output images.
                                The main and lores streams must always share the same colour space.
                                The raw stream is always in a camera-specific colour space.
                            </span>
                            <label for="{{ cfgId }}_colour_space">Colour Space:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_colour_space" id="{{ cfgId }}_colour_space">
                                {% if cfg.colour_space == "sYCC" %}
                                <option value="sYCC" selected>sYCC</option>
                                {% else %}
                                <option value="sYCC">sYCC</option>
                                {% endif %}
                                {% if cfg.colour_space == "Smpte170m" %}
                                <option value="Smpte170m" selected>Smpte170m</option>
                                {% else %}
                                <option value="Smpte170m">Smpte170m</option>
                                {% endif %}
                                {% if cfg.colour_space == "Rec709" %}
                                <option value="Rec709" selected>Rec709</option>
                                {% else %}
                                <option value="Rec709">Rec709</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                the number of sets of buffers to allocate for the camera system.
                                A single set of buffers represents
                                one buffer for each of the streams that have been requested.
                            </span>
                            <label for="{{ cfgId }}_buffer_count">Buffer Count:</label>
                        </td>
                        <td colspan="2">
                            <input type="number" id="{{ cfgId }}_buffer_count" name="{{ cfgId }}_buffer_count" min="1"
                                max="6" value="{{ cfg.buffer_count }}">
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is allowed to queue up a frame
                                ready for a capture request.
                            </span>
                            <label for="{{ cfgId }}_queue">Queue:</label>
                        </td>
                        <td colspan="2">
                            {% if cfg.queue == True %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" value="0">
                            {% endif %}
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Sensor Mode to be used in this configuration<br>
                                For details, see the available Sensor Modos under 'Info'
                            </span>
                            <label for="{{ cfgId }}_sensor_mode">Sensor Mode:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_sensor_mode" id="{{ cfgId }}_sensor_mode"
                                onchange="sensorModeChanged('{{ cfgId }}_sensor_mode', '{{ cfgId }}_sensor_mode_data')">
                                {% for mode in sm %}
                                {% if cfg.sensor_mode == mode.id %}
                                <option value="{{ mode.id }}" selected>Sensor Mode {{ mode.id }}</option>
                                {% else %}
                                <option value="{{ mode.id }}">Sensor Mode {{ mode.id }}</option>
                                {% endif %}
                                {% endfor%}
                            </select>
                        </td>
                        <td style="width:50%" id="{{ cfgId }}_sensor_mode_data">
                            {% for mode in sm %}
                            {% if cfg.sensor_mode == mode.id %}
                            Size: {{ mode.size }} FPS: {{ mode.fps }} Bit Depth: {{ mode.bit_depth }}
                            {% endif %}
                            {% endfor%}
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Camera stream to use
                            </span>
                            <label for="{{ cfgId }}_stream">Stream:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_stream" id="{{ cfgId }}_stream">
                                {% if cfg.stream == "main" %}
                                <option value="main" selected>main</option>
                                {% else %}
                                <option value="main">main</option>
                                {% endif %}
                                {% if cfg.stream == "lores" %}
                                <option value="lores" selected>lores</option>
                                {% else %}
                                <option value="lores">lores</option>
                                {% endif %}
                                {% if cfg.stream == "raw" %}
                                <option value="raw" selected>raw</option>
                                {% else %}
                                <option value="raw">raw</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Image format to be used
                            </span>
                            <label for="{{ cfgId }}_format">Format:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_format" id="{{ cfgId }}_format">
                                {% if cfg.format == "XBGR8888" %}
                                <option value="XBGR8888" selected>XBGR8888</option>
                                {% else %}
                                <option value="XBGR8888">XBGR8888</option>
                                {% endif %}
                                {% if cfg.format == "XRGB8888" %}
                                <option value="XRGB8888" selected>XRGB8888</option>
                                {% else %}
                                <option value="XRGB8888">XRGB8888</option>
                                {% endif %}
                                {% if cfg.format == "RGB888" %}
                                <option value="RGB888" selected>RGB888</option>
                                {% else %}
                                <option value="RGB888">RGB888</option>
                                {% endif %}
                                {% if cfg.format == "BGR888" %}
                                <option value="BGR888" selected>BGR888</option>
                                {% else %}
                                <option value="BGR888">BGR888</option>
                                {% endif %}
                                {% if cfg.format == "YUV420" %}
                                <option value="YUV420" selected>YUV420</option>
                                {% else %}
                                <option value="YUV420">YUV420</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the camera streams are to be shown in the preview window.
                                <br>
                                Note: Preview view is not used within this applacation.
                            </span>
                            <label for="{{ cfgId }}_display">Display:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_display" name="{{ cfgId }}_display" value="{{ cfg.display }}"
                                disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the streams are to be encoded if a video recording is
                                started.
                            </span>
                            <label for="{{ cfgId }}_encode">Encode:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_encode" name="{{ cfgId }}_encode" value="{{ cfg.encode }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5">
                            Controls included in Configuration
                        </td>
                    </tr>
                    {% for ctrl_key, ctrl_value in cfg.controls.items() %}
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <label for="{{ cfgId }}_display">{{ ctrl_key }}:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_display" name="{{ cfgId }}_display" value="{{ ctrl_value }}"
                                disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    {% endfor%}
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" type="submit" value="Submit">
            </form>
        </div>
    </div>

    <!-- Raw Photo configuration -->
    {% if sc.lastConfigTab == "cfgvideo" %}
    <div id="cfgvideo" class="cfggroup">
    {% else %}
    <div id="cfgvideo" class="cfggroup" style="display:none">
    {% endif %}
        <h4>Configuration for Raw Photo Taking</h4>
        {% set cfg = cfgvideo %}
        {% set cfgId = "VIDO" %}
        <div>
            <form method="post" action="{{ url_for('config.videoCfg') }}">
                <table class="w3-table-all">
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This is the unique ID of the configuration. It is only used to distinguish
                                different configuration sets within this application.
                                It is not relevant for the camera system.
                            </span>
                            <label for="{{ cfgId }}_id">ID:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_id" name="{{ cfgId }}_id" value="{{ cfg.id }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Usecase for this configuration.
                            </span>
                            <label for="{{ cfgId }}_use_case">Use Case:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_use_case" name="{{ cfgId }}_use_case" value="{{ cfg.use_case }}"
                                disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether camera images are horizontally or vertically mirrored,
                                or both (giving a 180 degree rotation).
                            </span>
                            <label for="{{ cfgId }}_transform_hflip">Transform (flip ↔ or ↕ ):</label>
                        </td>
                        <td style="width:5%">
                            ↔
                            {% if cfg.transform_hflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip"
                                value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip"
                                value="0">
                            {% endif %}
                        </td>
                        <td style="width:5%">
                            ↕
                            {% if cfg.transform_vflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip"
                                value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip"
                                value="0">
                            {% endif %}
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                The colour space of the output images.
                                The main and lores streams must always share the same colour space.
                                The raw stream is always in a camera-specific colour space.
                            </span>
                            <label for="{{ cfgId }}_colour_space">Colour Space:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_colour_space" id="{{ cfgId }}_colour_space">
                                {% if cfg.colour_space == "sYCC" %}
                                <option value="sYCC" selected>sYCC</option>
                                {% else %}
                                <option value="sYCC">sYCC</option>
                                {% endif %}
                                {% if cfg.colour_space == "Smpte170m" %}
                                <option value="Smpte170m" selected>Smpte170m</option>
                                {% else %}
                                <option value="Smpte170m">Smpte170m</option>
                                {% endif %}
                                {% if cfg.colour_space == "Rec709" %}
                                <option value="Rec709" selected>Rec709</option>
                                {% else %}
                                <option value="Rec709">Rec709</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                the number of sets of buffers to allocate for the camera system.
                                A single set of buffers represents
                                one buffer for each of the streams that have been requested.
                            </span>
                            <label for="{{ cfgId }}_buffer_count">Buffer Count:</label>
                        </td>
                        <td colspan="2">
                            <input type="number" id="{{ cfgId }}_buffer_count" name="{{ cfgId }}_buffer_count" min="1"
                                max="6" value="{{ cfg.buffer_count }}">
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is allowed to queue up a frame
                                ready for a capture request.
                            </span>
                            <label for="{{ cfgId }}_queue">Queue:</label>
                        </td>
                        <td colspan="2">
                            {% if cfg.queue == True %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" value="0">
                            {% endif %}
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Sensor Mode to be used in this configuration<br>
                                For details, see the available Sensor Modos under 'Info'
                            </span>
                            <label for="{{ cfgId }}_sensor_mode">Sensor Mode:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_sensor_mode" id="{{ cfgId }}_sensor_mode"
                                onchange="sensorModeChanged('{{ cfgId }}_sensor_mode', '{{ cfgId }}_sensor_mode_data')">
                                {% for mode in sm %}
                                {% if cfg.sensor_mode == mode.id %}
                                <option value="{{ mode.id }}" selected>Sensor Mode {{ mode.id }}</option>
                                {% else %}
                                <option value="{{ mode.id }}">Sensor Mode {{ mode.id }}</option>
                                {% endif %}
                                {% endfor%}
                            </select>
                        </td>
                        <td style="width:50%" id="{{ cfgId }}_sensor_mode_data">
                            {% for mode in sm %}
                            {% if cfg.sensor_mode == mode.id %}
                            Size: {{ mode.size }} FPS: {{ mode.fps }} Bit Depth: {{ mode.bit_depth }}
                            {% endif %}
                            {% endfor%}
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Camera stream to use
                            </span>
                            <label for="{{ cfgId }}_stream">Stream:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_stream" id="{{ cfgId }}_stream">
                                {% if cfg.stream == "main" %}
                                <option value="main" selected>main</option>
                                {% else %}
                                <option value="main">main</option>
                                {% endif %}
                                {% if cfg.stream == "lores" %}
                                <option value="lores" selected>lores</option>
                                {% else %}
                                <option value="lores">lores</option>
                                {% endif %}
                                {% if cfg.stream == "raw" %}
                                <option value="raw" selected>raw</option>
                                {% else %}
                                <option value="raw">raw</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Image format to be used
                            </span>
                            <label for="{{ cfgId }}_format">Format:</label>
                        </td>
                        <td colspan="2">
                            <select name="{{ cfgId }}_format" id="{{ cfgId }}_format">
                                {% if cfg.format == "XBGR8888" %}
                                <option value="XBGR8888" selected>XBGR8888</option>
                                {% else %}
                                <option value="XBGR8888">XBGR8888</option>
                                {% endif %}
                                {% if cfg.format == "XRGB8888" %}
                                <option value="XRGB8888" selected>XRGB8888</option>
                                {% else %}
                                <option value="XRGB8888">XRGB8888</option>
                                {% endif %}
                                {% if cfg.format == "RGB888" %}
                                <option value="RGB888" selected>RGB888</option>
                                {% else %}
                                <option value="RGB888">RGB888</option>
                                {% endif %}
                                {% if cfg.format == "BGR888" %}
                                <option value="BGR888" selected>BGR888</option>
                                {% else %}
                                <option value="BGR888">BGR888</option>
                                {% endif %}
                                {% if cfg.format == "YUV420" %}
                                <option value="YUV420" selected>YUV420</option>
                                {% else %}
                                <option value="YUV420">YUV420</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the camera streams are to be shown in the preview window.
                                <br>
                                Note: Preview view is not used within this applacation.
                            </span>
                            <label for="{{ cfgId }}_display">Display:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_display" name="{{ cfgId }}_display" value="{{ cfg.display }}"
                                disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the streams are to be encoded if a video recording is
                                started.
                            </span>
                            <label for="{{ cfgId }}_encode">Encode:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_encode" name="{{ cfgId }}_encode" value="{{ cfg.encode }}" disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5">
                            Controls included in Configuration
                        </td>
                    </tr>
                    {% for ctrl_key, ctrl_value in cfg.controls.items() %}
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td class="w3-tooltip">
                            <label for="{{ cfgId }}_display">{{ ctrl_key }}:</label>
                        </td>
                        <td colspan="2">
                            <input id="{{ cfgId }}_display" name="{{ cfgId }}_display" value="{{ ctrl_value }}"
                                disabled>
                        </td>
                        <td style="width:50%">
                        </td>
                    </tr>
                    {% endfor%}
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" type="submit" value="Submit">
            </form>
        </div>
    </div>

    <script>
        function openCfgTab(cfgTabName, cfgTabButton) {
            var i;
            var x = document.getElementsByClassName("cfggroup");
            for (i = 0; i < x.length; i++) {
                x[i].style.display = "none";
            }
            document.getElementById(cfgTabName).style.display = "block";

            var b = document.getElementsByClassName("configmenu");
            for (i = 0; i < b.length; i++) {
                b[i].classList = "w3-bar-item w3-button configmenu";
            }
            document.getElementById(cfgTabButton).classList = "w3-bar-item w3-button configmenu w3-light-green";
        }
    </script>
    <script>
        function sensorModeChanged(srcId, tgtId) {
            var src = document.getElementById(srcId);
            var val = src.value;
            var txt = document.getElementById("sensormode_ref" + val).innerText
            var tgt = document.getElementById(tgtId);
            tgt.innerText=txt
        }
    </script>
{% endblock %}